<!DOCTYPE html>
<!--[if IE 9]><html class="lt-ie10" lang="zh-cmn-Hans" > <![endif]-->
<html class="no-js" lang="zh-cmn-Hans" >

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ubuntu 8.04 Realtek 8168/8111 网卡不能上网解决办法 | r.4ntix Shawn's Noise Player</title>

  <link rel="stylesheet" href="http://r.durara.net/theme/css/normalize.css">
  <link rel="stylesheet" href="http://r.durara.net/theme/css/foundation.min.css">
  <link rel="stylesheet" href="http://r.durara.net/theme/css/typo.css">
  <link rel="stylesheet" href="http://r.durara.net/theme/css/pygments.css">
  <link rel="stylesheet" href="http://r.durara.net/theme/css/app.css">

  <script src="http://r.durara.net/theme/js/vendor/modernizr.js"></script>
</head>

<body>
  <!-- start of header -->
  <header class="contain-to-grid">
    <nav class="top-bar" data-topbar>
      <ul class="title-area">
        <li class="name">
          <h1><a href="http://r.durara.net">r.4ntix Shawn's Noise Player</a></h1>
        </li>
        <li class="toggle-topbar menu-icon"><a href="#">Menu</a></li>
      </ul>
      <section class="top-bar-section">
        <!-- Right Nav Section -->
        <ul class="right">
          <li><a href="http://r.durara.net/about/">About</a></li>
          <li>
            <a href="#">|</a>
          </li>
          <li><a href="https://www.readability.com/r4ntix/">Readability</a></li>
          <li><a href="http://instagram.com/r4ntix">Instagram</a></li>
          <li><a href="https://twitter.com/r4ntix">Twitter</a></li>
          <li><a href="https://plus.google.com/112109872395334308066">Google+</a></li>
        </ul>
      </section>
    </nav>
  </header>
  <!-- end of header -->

  <!-- start of content -->
  <div id="content" class="row">
    <div class="medium-9 large-10 columns">
      <div class="article typo">
        <h1 class="serif">Ubuntu 8.04 Realtek 8168/8111 网卡不能上网解决办法</h1>
        <!--  -->
<blockquote>
2008年10月16日：官方已经修复了网卡驱动的问题。</blockquote>
<div class="section" id="id1">
<h2>一、确定你也遭受同样的问题</h2>
<p>确定你的网卡为Realtek 8168/8111网卡，可用lspci 查看。你的Ubuntu 内核为 2.6.24，似乎现在只有这个内核或者更高内核，出现死活不能上网的问题。包括在Win 下打开wake-on-lan after shutdown 为enable，也不能上网。看看你现在Ubuntu 的网卡驱动是不是r8169，这个驱动对Realtek 8168/8111 竟然不支持，有人在官方提交了BUG 报告了，但现在还没更新。</p>
<p>并且你试图自己下载8168的驱动，自己安装的时候，出现错误：</p>
<div class="highlight"><pre>xuange@R-desktop:/usr/src/r8168-8.005.00<span class="nv">$ </span>sudo make clean modules
make -C src/ clean
make<span class="o">[</span>1<span class="o">]</span>: Entering directory <span class="sb">`</span>/usr/src/r8168-8.005.00/src<span class="s1">&#39;</span>
<span class="s1">rm -rf *.o *.ko *~ core* .dep* .*.d .*.cmd *.mod.c *.a *.s .*.flags .tmp_versions Module.symvers Modules.symvers rset</span>
<span class="s1">make[1]: Leaving directory `/usr/src/r8168-8.005.00/src&#39;</span>
make -C src/ modules
make<span class="o">[</span>1<span class="o">]</span>: Entering directory <span class="sb">`</span>/usr/src/r8168-8.005.00/src<span class="s1">&#39;</span>
<span class="s1">make -C /lib/modules/2.6.24-12-generic/build SUBDIRS=/src modules</span>
<span class="s1">make[2]: Entering directory `/usr/src/linux-headers-2.6.24-12-generic&#39;</span>
scripts/Makefile.build:41: /src/Makefile: No such file or directory
make<span class="o">[</span>3<span class="o">]</span>: *** No rule to make target <span class="sb">`</span>/src/Makefile<span class="s1">&#39;. Stop.</span>
<span class="s1">make[2]: *** [_module_/src] Error 2</span>
<span class="s1">make[2]: Leaving directory `/usr/src/linux-headers-2.6.24-12-generic&#39;</span>
make<span class="o">[</span>1<span class="o">]</span>: *** <span class="o">[</span>modules<span class="o">]</span> Error 2
make<span class="o">[</span>1<span class="o">]</span>: Leaving directory <span class="sb">`</span>/usr/src/r8168-8.005.00/src<span class="err">&#39;</span>
make: *** <span class="o">[</span>modules<span class="o">]</span> Error 2
xuange@R-desktop:/usr/src/r8168-8.005.00<span class="err">$</span>
</pre></div>
<p>现在，如果像我所说的一样，很不幸，你和我们一样，遇到了这个问题。 :(</p>
</div>
<div class="section" id="id2">
<h2>二、解决办法</h2>
<p>你需要安装一个patch 软件包，可以叫别人下了后拷贝给你：<a class="reference external" href="http://forum.ubuntu.org.cn/download/file.php?id=32364&amp;sid=2ada0f5b55bf226cab872bef441a6412">r8168-8.005.00版本驱动的Patch</a></p>
<p>下载Realtek 8168/8111网卡官方文件驱动，同样可以叫别人下了后拷贝给你，地址：
<a class="reference external" href="http://www.realtek.com.tw/downloads/downloadsView.aspx?Langid=1&amp;PNid=13&amp;PFid=5&amp;Level=5&amp;Conn=4&amp;DownTypeID=3&amp;GetDown=false">http://www.realtek.com.tw/downloads/downloadsView.aspx?Langid=1&amp;PNid=13&amp;PFid=5&amp;Level=5&amp;Conn=4&amp;DownTypeID=3&amp;GetDown=false</a></p>
<p>现在，我们可以动手了，自己编译驱动安装：</p>
<div class="highlight"><pre>tar xvjf r8168-8.005.00.tar.bz2

<span class="c"># 解压r8168-8.005.00.tar.bz2后，将补丁文件r8168-8.005.00.hardy.diff.txt，放在./r8168-8.005.00/src 里。</span>

<span class="nb">cd</span> ./r8168-8.005.00/src
patch &lt; r8168-8.005.00.hardy.diff.txt
<span class="nb">cd</span> ..
make clean
make modules
sudo make install
sudo depmod -a
sudo insmod ./src/r8168.ko
</pre></div>
<p>OK！ 不用重启，看看，是不是能上网了？嘿嘿。 :)</p>
<p>最后，感谢energymomentum 发的补丁文件。期待官方升级驱动...</p>
<p>补丁来源：<a class="reference external" href="http://ubuntuforums.org/showthread.php?p=4718501">《r8168 driver patch for 2.6.24 kernel and higher》</a></p>
</div>

      </div>
    </div>
    <div class="hide-for-small-only medium-3 large-2 columns">
      <ul class="side-nav">
        <li><time datetime="2008-04-28T00:00:00" class="serif">2008年04月28日</time></li>
        <li class="divider"></li>
        <li><span class="serif">Written by</span> <a href="#">r.4ntix Shawn</a></li>
        <li class="divider"></li>
        <li><span class="serif">Categories</span> <a href="#">Writings</a></li>
        <li class="divider"></li>
        <li><span class="serif">Tags</span> <a href="#">ubuntu</a> <a href="#">linux</a> </li>
      </ul>
    </div>
  </div>
  <!-- end of content -->

  <!-- start of footer -->
  <footer class="row">
    <div class="small-6 medium-6 large-6 columns">
      <small>
        Designed and Created(2005-2014) by <a href="http://r.durara.net/about/">r.4ntix Shawn</a>
        <br />
        ✎ Time waits for no one.
      </small>
    </div>
    <div class="small-6 medium-6 large-6 columns">
      <small class="right">
        Help from <a href="http://blog.getpelican.com/">Pelican</a> and <a href="http://foundation.zurb.com/">Foundation 5</a> and <a href="http://typo.sofish.de/">Typo.css</a>
        <br />
        ☂ Hosting on <a href="https://github.com/">GitHub</a> and <a href="https://gitcafe.com/">GitCafe</a>
      </small>
    </div>
  </footer>
  <!-- end of footer -->

  <script src="http://r.durara.net/theme/js/vendor/jquery.js"></script>
  <script src="http://r.durara.net/theme/js/foundation.min.js"></script>
  <script>
    $(document).foundation();
  </script>

  <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47845863-1', 'durara.net');
    ga('send', 'pageview');
  </script>
</body>

</html>