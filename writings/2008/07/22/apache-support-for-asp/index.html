<!DOCTYPE html>
<!--[if IE 9]><html class="lt-ie10" lang="zh-cmn-Hans" > <![endif]-->
<html class="no-js" lang="zh-cmn-Hans" >

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>让Apache/WampServer 支持ASP/ASP.NET | r.4ntix Blue's Noise Player</title>

  <link rel="stylesheet" href="http://antix.blue/theme/css/normalize.css">
  <link rel="stylesheet" href="http://antix.blue/theme/css/foundation.min.css">
  <link rel="stylesheet" href="http://antix.blue/theme/css/typo.css">
  <link rel="stylesheet" href="http://antix.blue/theme/css/pygments.css">
  <link rel="stylesheet" href="http://antix.blue/theme/css/app.css">

  <script src="http://antix.blue/theme/js/vendor/modernizr.js"></script>
</head>

<body>
  <!-- start of header -->
  <header class="contain-to-grid">
    <nav class="top-bar" data-topbar>
      <ul class="title-area">
        <li class="name">
          <h1><a href="http://antix.blue">r.4ntix Blue's Noise Player</a></h1>
        </li>
        <li class="toggle-topbar menu-icon"><a href="#">Menu</a></li>
      </ul>
      <section class="top-bar-section">
        <!-- Right Nav Section -->
        <ul class="right">
          <li><a href="http://antix.blue/about/">About</a></li>
          <li>
            <a href="#">|</a>
          </li>
          <li><a href="https://www.readability.com/r4ntix/">Readability</a></li>
          <li><a href="http://instagram.com/r4ntix">Instagram</a></li>
          <li><a href="https://twitter.com/r4ntix">Twitter</a></li>
          <li><a href="https://plus.google.com/112109872395334308066">Google+</a></li>
        </ul>
      </section>
    </nav>
  </header>
  <!-- end of header -->

  <!-- start of content -->
  <div id="content" class="row">
    <div class="medium-9 large-10 columns">
      <div class="article typo textwrap">
        <h1 class="serif">让Apache/WampServer 支持ASP/ASP.NET</h1>
        <div class="section" id="x00">
<h2>0X00 注解</h2>
<p>本文是基于WampServer 2.X 套件讨论的，但适用于截止到目前为止所有版本的Apache。其实我们也只是对WampServer 中的Apache 模块做了修改，使其能够支持ASP/ASP.NET。本文中Apache版本为2.2.8，WampServer 的目录地址为D:\wamp\ 。</p>
</div>
<div class="section" id="x01-asp-net">
<h2>0X01 ASP.NET</h2>
<p>让Apache 支持ASP.NET 比较简单，使用apache.org 里提供的mod_aspdotnet 即可。地址是：<a class="reference external" href="http://httpd.apache.org/modules/">http://httpd.apache.org/modules/</a></p>
<p>说一下配置：首先下载mod_aspdotnet，然后将其mod_aspdotnet.so 释放到apache 的/modules/ ，如D:\wamp\bin\apache\apache2.2.8\modules。然后，我们需要建立一个mod_aspdotnet 单独的配置文件.conf，如httpd-aspdotnet.conf，写好后放入apache的/conf/extra/中，这样比较规范。</p>
<p>httpd-aspdotnet.conf，如下：</p>
<div class="highlight"><pre><span class="c"># Load asp.net module</span>
<span class="nb">LoadModule</span> aspdotnet_module <span class="s2">&quot;modules/mod_aspdotnet.so&quot;</span>

<span class="c"># Set asp.net extensions</span>
<span class="nb">AddHandler</span> asp.net asax ascx ashx asmx aspx axd config cs csproj licx rem resources resx soap vb vbproj vsdisco webinfo

<span class="c"># 其中&quot;D:/wamp/www/aspx&quot;  为我们的ASPX 的文件的目录。需自己修改。：）</span>
<span class="nt">&lt;ifmodule</span> <span class="s">mod_aspdotnet.cpp</span><span class="nt">&gt;</span>
    <span class="c"># Mount the ASP.NET /ASP application</span>
    <span class="nb">AspNetMount</span> <span class="sx">/ASP</span> <span class="s2">&quot;D:/wamp/www/aspx&quot;</span>

    <span class="c"># Map all requests for /ASP to the application files</span>
    <span class="nb">Alias</span> <span class="sx">/ASP</span> <span class="s2">&quot;D:/wamp/www/aspx&quot;</span>

    <span class="c"># Allow asp.net scripts to be executed in the /ASP folder</span>
    <span class="nt">&lt;directory</span> <span class="s">&quot;D:/wamp/www/aspx&quot;</span><span class="nt">&gt;</span>
        <span class="c"># Set asp.net options</span>
        <span class="nb">Options</span> Indexes FollowSymLinks Includes +ExecCGI
        <span class="c"># Set asp.net permissions</span>
        <span class="nb">Order</span> allow,deny
        <span class="nb">Allow</span> from <span class="k">all</span>
        <span class="c"># Set asp.net default index page to .aspx and .htm</span>
        <span class="nb">DirectoryIndex</span> index.aspx index.htm
    <span class="nt">&lt;/directory&gt;</span>

    <span class="c"># Set aspnet_client files to serve the client-side helper scripts.  这里为我们的ASP.NET_Framework 的安装地址，需自己修改。</span>
    <span class="nb">AliasMatch</span> <span class="sx">/aspnet_client/system_web/</span>(\d+)_(\d+)_(\d+)_(\d+)/(.*) <span class="s2">&quot;C:/WINDOWS/Microsoft.NET/Framework/v3.5/ASP.NETClientFiles/$4&quot;</span>
    <span class="nt">&lt;directory</span> <span class="s">&quot;C:/WINDOWS/Microsoft.NET/Framework/v3.5/ASP.NETClientFiles&quot;</span><span class="nt">&gt;</span>
        <span class="nb">Options</span> FollowSymlinks
        <span class="nb">Order</span> allow,deny
        <span class="nb">Allow</span> from <span class="k">all</span>
    <span class="nt">&lt;/directory&gt;</span>
<span class="nt">&lt;/ifmodule&gt;</span>
</pre></div>
<p>这样写好httpd-aspdotnet.conf 后放入apache的/conf/extra/中，然后修改apache 的主配置文件/conf/httpd.conf 在其中适当位置加入代码：</p>
<div class="highlight"><pre><span class="c"># ASP.net ，写在httpd.conf 最后适当的位置。只是为了规范。</span>
<span class="nb">Include</span> conf/extra/httpd-aspdotnet.conf
</pre></div>
<p>然后，重启apache，现在/www/aspx/目录已经可以解析.aspx 文件了。：）</p>
</div>
<div class="section" id="x02-asp">
<h2>0X02 ASP</h2>
<p>让Apache 完美的支持asp，目前网上也没有好的解决办法，很多东西都还是商业的，以前有个mod 可以用，但只能用在apache1.X 上，很老的东西了。我找寻了很久也没有找到免费的解决办法。无意间得知phpnow 有个插件可以支持asp，马上下载下来玩了一下，终于成功让这个插件脱离phpnow，使其支持任意的Apache。其实phpnow 也是提取了试用版的ActiveHTML，效果还不错，我比较满意。</p>
<p>过程如下：首先下载这个phpnow 版的ActiveHTML，释放在一个适合的位置，如D:\wamp\bin\ActiveHTML\ ，ActiveHTML 需要注册几个.dll，运行CMD 在ActiveHTML 目录，执行如下命令：</p>
<div class="highlight"><pre># CMD 进入ActiveHTML目录，执行如下命令
regsvr<span class="m">32</span>.exe <span class="n">/s</span> slASP<span class="m">3</span>.dll
regsvr<span class="m">32</span>.exe <span class="n">/s</span> slDispatch.dll
regsvr<span class="m">32</span>.exe <span class="n">/s</span> MSXML<span class="m">4</span>.dll
regsvr<span class="m">32</span>.exe <span class="n">/s</span> MSXML<span class="m">4</span>R.dll
</pre></div>
<p>然后，同样的我们需要为ActiveHTML 写一个配置文件.conf，如httpd-ahtml.conf，如下：</p>
<div class="highlight"><pre><span class="c">##################################################</span>
<span class="c">#   Uncomment the following lines if you want</span>
<span class="c">#   to use Authorization environment-variables</span>
<span class="c">#   You may implement you own user</span>
<span class="c">#   authentication using LOGON_USER and</span>
<span class="c">#   LOGON_PASSWORD in your scripts (Login.asp)</span>
<span class="c">##################################################</span>
<span class="nb">LoadModule</span> rewrite_module modules/mod_rewrite.so
<span class="nb">RewriteEngine</span> <span class="k">On</span>
<span class="nb">RewriteCond</span>     %{HTTP:Authorization}   ^(.*)$ [NC]
<span class="nb">RewriteRule</span>     /.*             -       [E=HTTP_AUTHORIZATION:%1]
<span class="c">##################################################</span>

<span class="c"># Supports Imagemaps</span>
<span class="nb">AddHandler</span> imap-file map

<span class="c">##################################################</span>
<span class="c">#   Do not allow access to global.asa</span>
<span class="c">##################################################</span>
<span class="nt">&lt;files</span> <span class="s">~ &quot;global.asa&quot;</span><span class="nt">&gt;</span>
    <span class="nb">Order</span> allow,deny
    <span class="nb">Deny</span> from <span class="k">all</span>
    <span class="nb">Satisfy</span> <span class="k">All</span>
<span class="nt">&lt;/files&gt;</span>

<span class="c">##################################################</span>
<span class="c">#   Add ActiveHTML-Handler  其中”D:/wamp/bin/ActiveHTML“ 为ActiveHTML释放的目录，需自己修改。</span>
<span class="c">##################################################</span>
<span class="nb">ScriptAlias</span> <span class="sx">/asp_bin</span> <span class="s2">&quot;D:/wamp/bin/ActiveHTML&quot;</span>
<span class="nb">Action</span> ActiveHTML <span class="s2">&quot;/asp_bin/AHTML.exe&quot;</span>
<span class="nb">AddHandler</span> ActiveHTML .asp
<span class="nb">DirectoryIndex</span> index.asp default.asp

<span class="c">##################################################</span>
<span class="c">#   Add Sampledirectory Alias  其中&quot;D:/wamp/www/asp/&quot;为asp文件所在的目录，需自己修改。</span>
<span class="c">##################################################</span>
<span class="nt">&lt;directory</span> <span class="s">&quot;D:/wamp/bin/ActiveHTML&quot;</span><span class="nt">&gt;</span>
    <span class="nb">Options</span> Indexes MultiViews FollowSymLinks
    <span class="nb">AllowOverride</span> <span class="k">None</span>
    <span class="nb">Order</span> allow,deny
    <span class="nb">Allow</span> from <span class="k">all</span>
<span class="nt">&lt;/directory&gt;</span>

<span class="nb">Alias</span> <span class="sx">/asp/</span> <span class="s2">&quot;D:/wamp/www/asp/&quot;</span>
<span class="nt">&lt;directory</span> <span class="s">&quot;D:/wamp/www/asp/&quot;</span><span class="nt">&gt;</span>
    <span class="nb">Options</span> Indexes MultiViews FollowSymLinks
    <span class="nb">AllowOverride</span> <span class="k">all</span>
    <span class="nb">Order</span> allow,deny
    <span class="nb">Allow</span> from <span class="k">all</span>
<span class="nt">&lt;/directory&gt;</span>
</pre></div>
<p>同样的，在apache的主配置文件httpd.conf 里适当的位置加入代码：</p>
<div class="highlight"><pre><span class="c"># ASP ，写在httpd.conf 最后适当的位置。只是为了规范。</span>
<span class="nb">Include</span> conf/extra/httpd-ahtml.conf
</pre></div>
<p>然后，重启apache，现在/www/asp/目录已经可以解析.asp 文件了。：）</p>
</div>
<div class="section" id="x03-ps">
<h2>0X03 PS</h2>
<p>文章本来很早就打算写，从考试前一直拖到放假。也很久没跟新这个Time.log。于是乎，在这个安静的夜晚，终于写下了这个早就打算写的文章。晚安 ～～</p>
</div>

      </div>
    </div>
    <div class="hide-for-small-only medium-3 large-2 columns">
      <ul class="side-nav">
        <li><time datetime="2008-07-22T00:00:00+08:00" class="serif">2008年07月22日</time></li>
        <li class="divider"></li>
        <li><span class="serif">Written by</span> <a href="#">r.4ntix Shawn</a></li>
        <li class="divider"></li>
        <li><span class="serif">Categories</span> <a href="#">Writings</a></li>
        <li class="divider"></li>
        <li><span class="serif">Tags</span> <a href="#">apache</a> <a href="#">asp</a> <a href="#">wamp</a> <a href="#">.net</a> </li>
      </ul>
    </div>
  </div>
  <!-- end of content -->

  <!-- start of footer -->
  <footer class="row">
    <div class="small-6 medium-6 large-6 columns">
      <small>
        Designed and Created(2005-2014) by <a href="http://antix.blue/about/">r.4ntix Shawn</a>
        <br />
        ✎ Time waits for no one.
      </small>
    </div>
    <div class="small-6 medium-6 large-6 columns">
      <small class="right">
        Help from <a href="http://blog.getpelican.com/">Pelican</a> and <a href="http://foundation.zurb.com/">Foundation 5</a> and <a href="http://typo.sofish.de/">Typo.css</a>
        <br />
        ☂ Hosting on <a href="https://github.com/">GitHub</a> and <a href="https://gitcafe.com/">GitCafe</a>
      </small>
    </div>
  </footer>
  <!-- end of footer -->

  <script src="http://antix.blue/theme/js/vendor/jquery.js"></script>
  <script src="http://antix.blue/theme/js/foundation.min.js"></script>
  <script>
    $(document).foundation();
  </script>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47845863-1', 'auto');
    ga('send', 'pageview');
  </script>
</body>

</html>